open import Prelude 

module Language.STLC.ExplicitSub.Term where

open import Language.STLC.Context

infix 3 _РібрхЌ_ _Ріб╦б_
infixr 5 кЏ_
infixl 6 _┬и_
infixr 8 РЪф_РЪФ_

data _Ріб╦б_ {Рёг : ­ЮЊцРѓђ ╠Є} : (╬Њ ╬ћ : Context Рёг) Рєњ ­ЮЊцРѓђ ╠Є
data _РібрхЌ_ {Рёг : ­ЮЊцРѓђ ╠Є} : (╬Њ : Context Рёг) Рєњ (¤ё : Typ Рёг) Рєњ ­ЮЊцРѓђ ╠Є

private
  variable
    Рёг       : ­ЮЊцРѓђ ╠Є
    ╬Њ ╬ћ ╬ъ ╬ў : Context Рёг
    ¤ё ¤Ѓ     : Typ Рёг
    ╬┤ ╬│ ╬Й   : ╬Њ Ріб╦б ╬ћ
    t u s   : ╬Њ РібрхЌ ¤ё

private
  РЪф_РЪФРђ▓ : (¤Ѓ : ╬Њ Ріб╦б ╬ћ) Рєњ (t : ╬ћ РібрхЌ ¤ё)
    Рєњ ╬Њ РібрхЌ ¤ё
  vРђ▓    : ╬Њ , ¤ё РібрхЌ ¤ё

exts : ╬Њ Ріб╦б ╬ћ
  Рєњ ╬Њ , ¤ё Ріб╦б ╬ћ , ¤ё 

data _Ріб╦б_ {Рёг} where
  id : (╬Њ : Context Рёг)
    Рєњ ╬Њ Ріб╦б ╬Њ

  p  : ╬Њ , ¤ё Ріб╦б ╬Њ

  _,_ : (╬┤ : ╬Њ Ріб╦б ╬ћ) Рєњ (t : ╬Њ РібрхЌ ¤ё)
    Рєњ ╬Њ Ріб╦б ╬ћ , ¤ё

  _РеЪ_ : (╬┤ : ╬Њ Ріб╦б ╬ћ) Рєњ (╬Й : ╬ћ Ріб╦б ╬ъ)
    Рєњ ╬Њ Ріб╦б ╬ъ

  РеЪ-idрхБ : (╬┤ : ╬Њ Ріб╦б ╬ћ)
    Рєњ ╬┤ РеЪ id ╬ћ РЅА ╬┤

  РеЪ-idРѓЌ : (╬┤ : ╬Њ Ріб╦б ╬ћ)
    Рєњ id ╬Њ РеЪ ╬┤ РЅА ╬┤

  РеЪ-assoc : ╬┤ РеЪ (╬│ РеЪ ╬Й) РЅА (╬┤ РеЪ ╬│) РеЪ ╬Й

  РеЪ-proj : (╬┤ , t) РеЪ p РЅА ╬┤
  
  РеЪ-ext : ╬Й РеЪ (╬┤ , t) РЅА ((╬Й РеЪ ╬┤) , РЪф ╬Й РЪФРђ▓ t) -- ?

data _РібрхЌ_ where
  v    : ╬Њ , ¤ё РібрхЌ ¤ё

  РЪф_РЪФ_ : (¤Ѓ : ╬Њ Ріб╦б ╬ћ) Рєњ (t : ╬ћ РібрхЌ ¤ё)
    Рєњ ╬Њ РібрхЌ ¤ё
    
  v-id  : РЪф id (╬Њ , ¤ё) РЪФ v РЅА v

  v-ext : РЪф ╬┤ , t РЪФ v РЅА t 

  кЏ_   : (t : ╬Њ , ¤Ѓ РібрхЌ ¤ё)
    Рєњ ╬Њ РібрхЌ ¤Ѓ Рєњ╠Є ¤ё

  abs-subst :
    РЪф ╬┤ РЪФ (кЏ t) РЅА кЏ РЪф exts ╬┤ РЪФ t -- inductive-recursive type? 

  _┬и_  : (s : ╬Њ РібрхЌ ¤Ѓ Рєњ╠Є ¤ё) Рєњ (t : ╬Њ РібрхЌ ¤Ѓ)
    Рєњ ╬Њ РібрхЌ ¤ё

  app-subst :
    РЪф ╬┤ РЪФ (t ┬и s) РЅА РЪф ╬┤ РЪФ t ┬и РЪф ╬┤ РЪФ s


РЪф_РЪФРђ▓   = РЪф_РЪФ_
vРђ▓     = v
exts ╬┤ = p РеЪ ╬┤ , v
